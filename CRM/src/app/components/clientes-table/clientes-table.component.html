<h2>Listado de clientes</h2>

<div class="filtros">
  <label>
    Nombre:
    <input
      type="text"
      [(ngModel)]="filtroNombre"
      (input)="onFiltrar()"
      placeholder="Buscar por nombre">
  </label>

  <label>
    CIF:
    <input
      type="text"
      [(ngModel)]="filtroCif"
      (input)="onFiltrar()"
      placeholder="Buscar por CIF">
  </label>

  <button (click)="onLimpiarFiltros()">Limpiar filtros</button>
</div>

<div *ngIf="cargando">Cargando clientes...</div>
<div *ngIf="error" class="error">{{ error }}</div>

<table *ngIf="!cargando && clientes.length > 0">
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>CIF</th>
      <th>Dirección</th>
      <th>Email</th>
      <th>Teléfono</th>
      <th>Acciones</th> </tr>
  </thead>
  <tbody>
    <tr *ngFor="let c of clientes">
      <td>{{ c.id }}</td>
      <td>{{ c.nombre }}</td>
      <td>{{ c.cif }}</td>
      <td>{{ c.direccion }}</td>
      <td>{{ c.email }}</td>
      <td>{{ c.telefono }}</td>
      <td>
        <button (click)="abrirFormularioContacto(c)" style="background-color: #17a2b8; color: white; border: none;">
          + Contacto
        </button>
      </td>
    </tr>
  </tbody>
</table>

<div *ngIf="!cargando && clientes.length === 0">
  No hay clientes que coincidan con los filtros.
</div>

@if (clienteSeleccionadoId) {
  <div class="modal d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
    <div class="modal-dialog">
      <div class="modal-content">
        
        <div class="modal-header">
          <h5 class="modal-title">Añadir Contacto</h5>
          <button type="button" class="btn-close" (click)="cerrarFormulario()"></button>
        </div>
        
        <div class="modal-body">
          <app-contacto-form 
            [clienteId]="clienteSeleccionadoId"
            (onSave)="onContactoGuardado()"
            (onCancel)="cerrarFormulario()">
          </app-contacto-form>
        </div>

      </div>
    </div>
  </div>
}